# 소유권 기록에서 모든 것이 시작된다 (p88 ~p96)

이력으로 현재 소유권 상태 알아내기

이어달리기에서 바통을 다루는 것을 비유로, **블록체인이 소유권을 취급하는 것**을 설명

<br>

## 1. 목표: 누가 보더라도 명확히 알 수 있게 소유권 기록하기

소유권을 투명하고 누구나 이해 가능한 방식으로 기록하기

<br>

## 2. 해결해야 할 과제

단순히 소유권에 대한 주장만 기록하는 것이 아닌, `소유권에 대한 증거`까지 제공하여 소유권 자체를 증명하는 기록 방법 찾아내기

<br>

## 3. 아이디어

소유권의 현 상태를 재산 목록 데이터 형태로 단순 기술 하지 않고, 소유권이 이전된 이력까지 원장에 빠짐 없이 기록 보관하기

- 즉, 소유권 이전이 일어날 때마다 트렌젝션 데이터는 누가 누구에게 어떤 아이템의 `소유권을 언제 이전했는지` 기록
- 이어달리기에서 `바통을 건넨 이력`을 기록하는 것과 같음

<br>

## 4. 목록과 트랜젝션 데이터는 어떻게 다른가

#### 소유권을 기술하는 방식

1. 소유권 목록 작성
2. 트랜젝션 데이터 작성

- **소유권 목록**: 소유권의 현 상태 설명
  - 단순히 소유권을 주장
  - 예시) 잔고증명서
- **트랜젝션 데이터**: 소유권의 이전 이력 기술
  - 소유권을 설명하고 증명
  - 예시) 거래내역조회서

<br>

## 5. 작동 원리

### 1) 소유권 이전을 기술

트랜잭션은 **현 소유자의 소유권을 다른 사람에게 이전하는 행위**를 의미

- 소유권의 이전은 데이터에 기록함으로써 이뤄짐

#### 블록체인이 트랜젝션을 기술하기 위해 사용되는 정보

- 다른 계정으로 소유권을 이전하려는 계정의 `식별자`
- 소유권을 이전 받으려는 계정의 `식별자`
- 이전하려는 재화의 `총액`
- 이전이 완료되는 `시각`
- 이전하기 위해 시스템에 지불해야 하는 `수수료`
- 이전에 동의한다는 원소유자의 `증명`

이 과정은 은행의 계좌이체 서식과 유사하다.

<br>

### 2) 트랜잭션 이력의 유지

#### 트랜잭션을 수행한다는 것의 2가지 의미

1. 트랜잭션 데이터에 기록된 대로 소유권의 이전이 일어난다는 것
2. 원장에 트랜잭션 데이터를 추가한다는 것
   <br>

#### 새로 추가된 트랜잭션

-> 트랜잭션 이력의 한 부분이 되고, 이후 이 이력은 소유권을 명확화할 때 사용
-> 소유권 명확화를 위해 트랜잭션 데이터 이용 시, 새로 추가된 트랜잭션도 함께 합쳐져 소유권 상태의 최종 결과에 영향을 미침

<br>

블록체인은 모든 트랜 트랜잭션을 먼저 기록된 순서대로 `블록체인-데이터-구조`에 저장하여 전체 이력을 유지한다.
-> 이 트랜잭션을 실제 발생시키고 그 이력을 통해 **현재 소유권을 식별하는 데 영향**을 미칠 수 있게 한다는 의미

<br>

## 6. 작동하는 이유

트랜잭션 데이터는 **소유권을 이전하려는 계정에 대한 모든 정보**를 가지고 있음

- 트랜잭션의 전체 이력이 존재하면
  → 각각의 계정에 대해 소유권을 이전 받은 계정, 이전된 아이템과 총액에 대한 소유권 정보를 **재구성** 할 수 있음

  <br>

## 7. 트랜잭션 순서가 중요하다

트랜잭션 데이터를 합치는 이유는, 소유권 이전 내역을 재구성해 **현 소유권자를 찾아내고 소유권을 명확화**하려는 목적

- 트랜잭션이 **발생했던 순서 그대로 동일하게 재현**되는 것이 매우 중요

> **비유: 친구에게 50달러를 받는 순서의 중요성**
> 얼핏 생각하면 내가 친구에게 50달러를 받아 그 돈으로 요금을 지불하는 것이나, 먼저 요금을 지불하고 친구에게 50달러를 받는 것이나 별차이 없어 보인다.
>
> 그러나 은행 계좌에 잔고가 없고, 잔고 이상의 돈을 인출할 수 없는 경우는 어떻게 되는가?
>
> 친구한테 돈을 받는 시점보다 인출 시점이 앞선다면, 계좌이체 요청에 대해 은행은 잔고 부족을 이유로 거절할 것이다. 즉, 나의 요금 지불 능력은 친구한테 돈을 언제 받았는지(트랜잭션이 일어난 순서)에 달려 있다.

<br>

## 8. 트랜잭션 이력의 무결성을 유지하기 위해 필요한 3요소

`트랜잭션 데이터의 이력`이야말로 **소유권을 관리하는 블록체인의 심장**이라고 할 수 있음

- 소유권 상태를 재구성하는 가장 기본이 되는 요소
- 이를 통해 현 소유자를 명확히 판단할 수 있음
  → 전체 시스템의 무결성을 지키려면 `이력 데이터`를 안전하고 완전하며, 정확하고 일관되게 유지할 필요가 있다.

<br>

### 1) 형식적 정확성

트랜잭션 데이터가 필요한 모든 정보를 정확한 형식으로 기술하는 것을 의미

<br>

### 2) 의미상 정확성

트랜잭션 데이터의 의미와 의도한 결과와 관련이 있다.
-> 의미상 정확성을 검증하기 위해서는 해당 사업 영역에 대한 지식이 필요함(업계의 관행)

예시)

- 계정에 있는 잔고 이상의 금액이 이전되지 않도록 보장
- 이중사용을 방지해야 한다.
- 한 번의 트랜잭션으로 이전 가능한 최대 금액에 제한을 둔다.
- 사용자 한 명당 가능한 트랜잭션 횟수에 제한을 둔다.
- 일정 기간 내 사용할 수 있는 총 금액에 제한을 둔다.
- 아이템의 소유권을 이전하려면 일정 기간 이상 보유해야 한다.

<br>

### 3) 승인

소유권을 이전하는 소유권자 본인만, 자신을 대신해 트랜잭션을 실행해 달라고 블록체인에 요청할 수 있어야 한다.

- 따라서, 트랜잭션 데이터는 **게좌 소유자가 정말로 소유권 이전에 동의하는지 증명할 수 있는 정보**를 반드시 가지고 있어야함
